<!DOCTYPE html>
<html>
	<title>...eppur si muove.</title>
	<head>
		<script type = "text/javascript" src = "./external/threejs/Three.js"></script>
		<script type = "text/javascript" src = "./external/dat.gui.min.js"></script>
		<script type = "text/javascript" src = "./external/Stats.js"></script>
		
		<script type = "text/javascript" src = "isaac_math.js"></script>
		<script type = "text/javascript" src = "isaac_obj.js"></script>
		<script type = "text/javascript" src = "isaac_core.js"></script>
		<script type = "text/javascript" src = "isaac_orbit_phys.js"></script>
		<style type = "text/css">
			body { 
				margin: 0px; 
				overflow: hidden;
			}
		</style>
	</head>
	<body>
		<div id="renderArea"></div>
		
		<script type = "text/javascript">
			// Three.js elements.
			var camera, scene, renderer;
			
			// Stats (for debugging)
			var stats;
			
			// Planets and their materials.
			var sunModel, earthModel;
			var sunMaterial, earthMaterial;
			
			init();
			
			function init() {
				// ------ GUI Initialisation ------ //
				var gui = new dat.GUI();
				gui.add(config, 'Update Step', 10, 100);
				// TODO: use this to allow mass of planets to be changed.
				
				// ------ End of GUI Initialisation ------ //
				
				// ------ FPS Counter (for debug only) ------ //
				stats = new Stats();
				stats.getDomElement().style.position = 'absolute';
				stats.getDomElement().style.left = '0px';
				stats.getDomElement().style.top = '0px';

				document.body.appendChild( stats.getDomElement() );

				setInterval( function () { stats.update(); }, 1000 / 60 );
				// ------ End of FPS Counter ------ //
				
				// Get the renderArea.
				var renderArea = document.getElementById('renderArea');
				
				// Setup the camera and scene.
				camera = new THREE.PerspectiveCamera(90, window.innerWidth/window.innerHeight, 1, 10000);
				camera.position.z = 600;
				scene = new THREE.Scene();
				scene.add(camera);
				
				// Setup the renderer.
				renderer = new THREE.CanvasRenderer();
				renderer.setSize(window.innerWidth, window.innerHeight);
				renderArea.appendChild(renderer.domElement);
				renderer.setClearColorHex(0xEEEEEE, 1.0);
				renderer.clear();
				
				// Create the Sun.
				sunMaterial = new THREE.MeshLambertMaterial( { color: 0xCC0000 } );
				sunModel = new THREE.Mesh(new THREE.SphereGeometry(50, 16, 16), sunMaterial);
				
				// Create the Earth.
				earthMaterial = new THREE.MeshLambertMaterial( { color: 0x458B00 } );
				earthModel = new THREE.Mesh( new THREE.SphereGeometry(25, 16, 16), earthMaterial);
				earthModel.position.z = 149.598261;
				
				// Add everything to the scene.
				scene.add(sunModel);
				scene.add(earthModel);
				
				// Render.
				renderer.render(scene, camera);
			}
			
			function animUpdate() {
				// Update the objects in the physics layer.
				update();
				
				// Update the graphical representations of the objects.
				objUpdate(Earth, earthModel);
					
				// Setup continuous updates.
				window.requestAnimationFrame(animUpdate, renderer.domElement);
				
				// Render!
				renderer.render(scene, camera);
			}
			
			animUpdate();
			
			function objUpdate(object, model) {
				model.position.x = object.motion.position[0];
				model.position.y = object.motion.position[1];
				model.position.z = object.motion.position[2];
			}
			
		</script>
	</body>
</html>